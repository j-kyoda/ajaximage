(function(f){f.fn.ajaximage=function(k){function e(c){for(var a="",b=0;b<c.length;b++)a+=String.fromCharCode(c[b]);return a}function g(c,a){for(var b="",d=0;d<a;d++)b+=c[d];return b}function l(c,a){var b="";a===m?(b=c.data("original_src"),console.log("original_src: "+b),b===m&&(b=c.attr("src"),console.log("image_url: "+b),c.data("original_src",b),c.attr("src",""))):(console.log("change_url: "+a),b=a,c.data("original_src",a));var d=(new Date).getTime();console.log(d);f.ajax({url:b,type:"POST",data:{serial:d},
dataType:"binary",beforeSend:function(c){c.overrideMimeType("text/plain; charset=x-user-defined")},converters:{"* binary":function(c){for(var b=[],a="",d=0;d<c.length;d++)b[d]=c.charCodeAt(d)&255,a+=String.fromCharCode(b[d]);return a}},success:function(b){var a;if(g(b,4)===e([137,80,78,71]))a="image/png";else{if(a=g(b,2)===e([255,216])){a="";for(var d=0;2>d;d++)a+=b[b.length-2+d];a=a===e([255,217])}a=a?"image/jpeg":g(b,4)===e([71,73,70,56])?"image/gif":g(b,2)===e([66,77])?"image/bmp":"image/unknown"}b=
"data:"+a+";base64,"+btoa(b);c.attr("src",b)},error:function(b,a,c){console.log("error: "+a+":"+c)}})}var m,h={create:function(){return this.each(function(c){c=f(this);l(c)})},change:function(c){return this.each(function(a){a=f(this);l(a,c)})}};return h[k]?h[k].apply(this,Array.prototype.slice.call(arguments,1)):h.create.apply(this)}})(jQuery);
